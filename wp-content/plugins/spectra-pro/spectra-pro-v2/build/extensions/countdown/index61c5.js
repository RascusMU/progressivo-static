(()=>{"use strict";var e={6667:(e,t,r)=>{r.d(t,{tL:()=>c,Fb:()=>i});const n=window.wp.blockEditor,o=window.wp.components,a=window.wp.i18n;var l=r(7462);const s=window.ReactJSXRuntime,i=(e,t)=>{if(!t)return e;const{attributes:{timerType:r,uniqueId:n},setAttributes:l,clientId:i}=t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>"date"!==r,label:(0,a.__)("Timer Type","spectra-pro"),onDeselect:()=>l({timerType:"date"}),isShownByDefault:!0,panelId:i,children:(0,s.jsxs)(o.__experimentalToggleGroupControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,isBlock:!0,label:(0,a.__)("Timer Type","spectra-pro"),value:r||"date",onChange:e=>{l({timerType:e}),"evergreen"!==e||n||l({uniqueId:i+"_"+Date.now()})},help:(0,a.__)("Choose the type of countdown timer to display.","spectra-pro"),children:[(0,s.jsx)(o.__experimentalToggleGroupControlOption,{label:(0,a.__)("Date","spectra-pro"),value:"date"}),(0,s.jsx)(o.__experimentalToggleGroupControlOption,{label:(0,a.__)("Evergreen","spectra-pro"),value:"evergreen"})]})}),"evergreen"===r&&(0,s.jsx)(p,{...t})]})},p=e=>{const{attributes:{evergreenDays:t,evergreenHours:r,evergreenMinutes:n,resetAfterDays:i,uniqueId:p},setAttributes:c,clientId:d}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>0!==t,label:(0,a.__)("Days","spectra-pro"),onDeselect:()=>c({evergreenDays:0}),isShownByDefault:!0,panelId:d,children:(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Days","spectra-pro"),value:t,onChange:e=>{c({evergreenDays:e}),(0,l.ou)(p)},min:0,max:365,step:1})}),(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>0!==r,label:(0,a.__)("Hours","spectra-pro"),onDeselect:()=>c({evergreenHours:0}),isShownByDefault:!0,panelId:d,children:(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Hours","spectra-pro"),value:r,onChange:e=>{c({evergreenHours:e}),(0,l.ou)(p)},min:0,max:23,step:1})}),(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>0!==n,label:(0,a.__)("Minutes","spectra-pro"),onDeselect:()=>c({evergreenMinutes:0}),isShownByDefault:!0,panelId:d,children:(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Minutes","spectra-pro"),value:n,onChange:e=>{c({evergreenMinutes:e}),(0,l.ou)(p)},min:0,max:59,step:1})}),(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>0!==i,label:(0,a.__)("Reset After (Days)","spectra-pro"),onDeselect:()=>c({resetAfterDays:0}),isShownByDefault:!0,panelId:d,children:(0,s.jsx)(o.RangeControl,{label:(0,a.__)("Reset After (Days)","spectra-pro"),value:i,onChange:e=>c({resetAfterDays:e}),min:0,max:365,step:1,help:(0,a.__)("Number of days to wait until the evergreen is reset for visitors. If set to 0, the timer restarts immediately after expiring.","spectra-pro")})})]})},c=(e,t)=>{if(!t)return e;const{attributes:{timerEndAction:r,redirectURL:l,reloadRequired:i,autoReload:p},setAttributes:c,clientId:u}=t;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d,{...t}),(0,s.jsx)(n.InspectorControls,{group:"settings",children:(0,s.jsxs)(o.__experimentalToolsPanel,{label:(0,a.__)("Expiry Settings","spectra-pro"),resetAll:()=>{c({timerEndAction:"zero",redirectURL:"",reloadRequired:!0,autoReload:!1})},panelId:u,children:[(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>"zero"!==r,label:(0,a.__)("Timer End Action","spectra-pro"),onDeselect:()=>c({timerEndAction:"zero"}),isShownByDefault:!0,panelId:u,children:(0,s.jsxs)(o.__experimentalToggleGroupControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,isBlock:!0,label:(0,a.__)("Timer End Action","spectra-pro"),value:r||"zero",onChange:e=>{"replace"!==e&&c({editorInnerBlocksPreview:!1}),c({timerEndAction:e})},help:(0,a.__)("For a better editing experience, expiry options work only on frontend.","spectra-pro"),children:[(0,s.jsx)(o.__experimentalToggleGroupControlOption,{label:(0,a.__)("Keep","spectra-pro"),value:"zero"}),(0,s.jsx)(o.__experimentalToggleGroupControlOption,{label:(0,a.__)("Hide","spectra-pro"),value:"hide"}),(0,s.jsx)(o.__experimentalToggleGroupControlOption,{label:(0,a.__)("Redirect","spectra-pro"),value:"redirect"}),(0,s.jsx)(o.__experimentalToggleGroupControlOption,{label:(0,a.__)("Replace","spectra-pro"),value:"replace"})]})}),"redirect"===r&&(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>""!==l,label:(0,a.__)("Redirect URL","spectra-pro"),onDeselect:()=>c({redirectURL:""}),isShownByDefault:!0,panelId:u,children:(0,s.jsx)(o.TextControl,{label:(0,a.__)("Redirect URL","spectra-pro"),value:l,onChange:e=>c({redirectURL:e}),placeholder:(0,a.__)("https://example.com","spectra-pro")})}),"replace"===r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>!0!==i,label:(0,a.__)("Reload Required","spectra-pro"),onDeselect:()=>c({reloadRequired:!0}),isShownByDefault:!0,panelId:u,children:(0,s.jsx)(o.ToggleControl,{label:(0,a.__)("Reload Required","spectra-pro"),checked:i,onChange:e=>c({reloadRequired:e}),help:i?(0,a.__)("Recommended: Expired content is only rendered after reload when countdown expires.","spectra-pro"):(0,a.__)("Expired content is rendered but visibly hidden until countdown expires.","spectra-pro")})}),i&&(0,s.jsx)(o.__experimentalToolsPanelItem,{hasValue:()=>!1!==p,label:(0,a.__)("Automatically Reload","spectra-pro"),onDeselect:()=>c({autoReload:!1}),isShownByDefault:!0,panelId:u,children:(0,s.jsx)(o.ToggleControl,{label:(0,a.__)("Automatically Reload","spectra-pro"),checked:p,onChange:e=>c({autoReload:e}),help:(0,a.__)("Automatically reload the page when timer ends.","spectra-pro")})})]})]})})]})},d=e=>{const{attributes:{timerEndAction:t,editorInnerBlocksPreview:r},setAttributes:l}=e;return"replace"!==t?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.BlockControls,{children:(0,s.jsxs)(o.Toolbar,{children:[(0,s.jsx)(o.ToolbarButton,{text:(0,a.__)("Live","spectra-pro"),label:(0,a.__)("Live","spectra-pro"),isActive:!r,onClick:()=>l({editorInnerBlocksPreview:!1})}),(0,s.jsx)(o.ToolbarButton,{text:(0,a.__)("Expired","spectra-pro"),label:(0,a.__)("Expired","spectra-pro"),isActive:r,onClick:()=>l({editorInnerBlocksPreview:!0})})]})})})}},7462:(e,t,r)=>{r.d(t,{ll:()=>n,ou:()=>p});const n=(e=0,t=0,r=0,n="",l=1)=>{if(!n)return null;const c=s(n),d=i(n),u=a(c),_=a(d);if(u&&_){const e=new Date(u),t=new Date(_),r=new Date;if(!isNaN(e.getTime())&&e>r)return u;if(l>0){const e=24*l*60*60*1e3;if(r.getTime()-t.getTime()<e)return u}p(n)}const m=1e3*(24*e*60*60+60*t*60+60*r);if(m<=0)return null;const g=new Date,x=l>0?l:1,h=new Date(g.getTime()+m).toISOString().replace(/\.\d{3}Z$/,"Z");return o(c,h,x),o(d,g.toISOString(),x),h},o=(e,t,r)=>{const n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3);const o=`expires=${n.toUTCString()}`;document.cookie=`${e}=${encodeURIComponent(t)}; ${o}; path=/; SameSite=Strict`},a=e=>{const t=`${e}=`,r=document.cookie.split(";");for(let e of r)if(e=e.trim(),0===e.indexOf(t))return decodeURIComponent(e.substring(t.length));return null},l=e=>{document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; SameSite=Strict`},s=e=>`spectra_countdown_evergreen_end_${e}`,i=e=>`spectra_countdown_evergreen_start_${e}`,p=e=>{l(s(e)),l(i(e))}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const n=window.wp.hooks;var o=r(6667),a=r(7462);(0,n.addFilter)("spectra.countdown.timer-settings","spectra-pro/countdown/add-timer-settings",o.Fb),(0,n.addFilter)("spectra.countdown.expiry-settings","spectra-pro/countdown/add-expiry-settings",o.tL),(0,n.addFilter)("blocks.registerBlockType","spectra-pro/countdown/add-attributes",((e,t)=>"spectra/countdown"!==t?e:{...e,attributes:{...e.attributes,timerEndAction:{type:"string",default:"zero"},redirectURL:{type:"string",default:""},reloadRequired:{type:"boolean",default:!0},autoReload:{type:"boolean",default:!1},evergreenDays:{type:"number",default:0},evergreenHours:{type:"number",default:0},evergreenMinutes:{type:"number",default:0},uniqueId:{type:"string"},resetAfterDays:{type:"number",default:1},editorInnerBlocksPreview:{type:"boolean",default:!1}}})),(0,n.addFilter)("spectra.countdown.calculateTime","spectra-pro/countdown/add-calculate-time",((e,t,r)=>{const{timerType:n,evergreenDays:o=0,evergreenHours:l=0,evergreenMinutes:s=0,showDays:i,showHours:p,showMinutes:c,showSeconds:d,uniqueId:u="",resetAfterDays:_=1}=t;if("date"===n||"function"!=typeof r||0===o&&0===l&&0===s)return e;const m=(0,a.ll)(o,l,s,u,_);return!m||isNaN(new Date(m).getTime())?{...e,days:0,hours:0,minutes:0,seconds:0,isExpired:!0}:r(m,i,p,c,d)})),(0,n.addFilter)("spectra.countdown.template","spectra-pro/countdown/extend-template",(e=>[...e,["spectra/countdown-child-expiry-wrapper",{lock:{move:!0,remove:!0}}]])),(0,n.addFilter)("spectra.countdown.reset-all-attributes","spectra-pro/countdown/add-reset-all-attributes",(()=>({timerEndAction:"zero",redirectURL:"",autoReload:!1,evergreenDays:0,evergreenHours:0,evergreenMinutes:0,resetAfterDays:1}))),(0,n.addFilter)("spectra.countdown.calculateTime.dependencies","spectra-pro/countdown/extend-calculate-deps",((e,t)=>{const{evergreenDays:r,evergreenHours:n,evergreenMinutes:o}=t;return{...e,evergreenDays:r,evergreenHours:n,evergreenMinutes:o}}))})();